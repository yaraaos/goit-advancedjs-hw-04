{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/js/button.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\nconst API_KEY = '48071665-33e10630f84311df29ef7637b';\n\nasync function getImages({ page, perPage, query }) {\n  const { data } = await axios.get('', {\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page,\n      per_page: perPage,\n    },\n  });\n  return data;\n}\n\nexport { getImages };","function createCardsMarkup(cards) {\n    return cards\n      .map(\n        ({\n          webformatURL,\n          largeImageURL,\n          tags,\n          likes,\n          views,\n          comments,\n          downloads,\n        }) => {\n          return `<li class='gallery-item'>\n          <a class=\"gallery-link\" href=\"${largeImageURL}\" >\n          <img\n              class=\"gallery-image\"\n              src=\"${webformatURL}\"\n              alt=\"${tags}\"\n              width='358'\n              height='200'\n              />\n      </a>\n      <ul class='img-info'>\n      <li><p>Likes</p><p>${likes}</p></li>\n      <li><p>Views</p><p>${views}</p></li>\n      <li><p>Comments</p><p>${comments}</p></li>\n      <li><p>Downloads</p><p>${downloads}</p></li>\n      </ul>\n  </li>`;\n        }\n      )\n      .join('');\n  }\n  \n  export default createCardsMarkup;","export default class ButtonService {\n    static HIDDEN_CLASS = 'is-hidden';\n  \n    constructor(buttonEl) {\n      this.button = buttonEl;\n      this.prevText = '';\n    }\n  \n    disable() {\n      this.button.disabled = true;\n    }\n  \n    enable() {\n      this.button.disabled = false;\n    }\n  \n    hide() {\n      this.button.classList.add(ButtonService.HIDDEN_CLASS);\n    }\n  \n    show() {\n      this.button.classList.remove(ButtonService.HIDDEN_CLASS);\n    }\n  \n    setLoading() {\n      this.disable();\n      this.prevText = this.button.textContent;\n      this.button.textContent = 'Loading...';\n    }\n  \n    setNormal() {\n      this.button.textContent = this.prevText;\n      this.enable();\n    }\n  }","import { getImages } from './js/pixabay-api';\nimport createCardsMarkup from './js/render-functions';\nimport ButtonService from './js/button';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet galleryLink = new SimpleLightbox('.gallery-link', {\n  captionDelay: 250,\n  captionsData: 'alt',\n});\n\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMore = document.querySelector('.js-load-more');\nconst loadMoreBtnService = new ButtonService(loadMore);\n\nconst searchForm = document.querySelector('.form');\n\nconst params = {\n  page: 1,\n  perPage: 15,\n  maxPage: 1,\n  query: '',\n};\n\nsearchForm.addEventListener('submit', handleSearch);\n\nasync function handleSearch(e) {\n  e.preventDefault();\n  gallery.innerHTML = '';\n\n  loadMoreBtnService.hide();\n  params.page = 1;\n\n  const form = e.currentTarget;\n  loader.style.display = 'block';\n\n  const userQuery = form.elements.search.value.trim();\n\n  params.query = userQuery;\n\n  try {\n    const data = await getImages(params);\n\n    if (data.total === 0) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n    }\n    params.maxPage = Math.ceil(data.totalHits / params.perPage);\n    gallery.innerHTML = createCardsMarkup(data.hits);\n    galleryLink.refresh();\n\n    if (params.maxPage > params.page) {\n      loadMoreBtnService.show();\n\n      loadMore.addEventListener('click', handlePagination);\n    }\n  } catch (err) {\n    console.error(err);\n  } finally {\n    loader.style.display = 'none';\n    form.reset();\n  }\n}\n\nasync function handlePagination(e) {\n  loadMoreBtnService.setLoading();\n  params.page += 1;\n  loader.style.display = 'block';\n\n  try {\n    const data = await getImages(params);\n\n    const photosMarkup = createCardsMarkup(data.hits);\n\n    gallery.insertAdjacentHTML('beforeend', photosMarkup);\n    galleryLink.refresh();\n\n    let elem = document.querySelector('.gallery-item');\n    let rect = elem.getBoundingClientRect();\n    for (const key in rect) {\n      if (typeof rect[key] !== 'function') {\n        window.scrollBy({\n          top: 2 * rect.height,\n          behavior: 'smooth',\n        });\n      }\n    }\n\n    loadMoreBtnService.setNormal();\n\n    if (params.maxPage === params.page) {\n      loadMoreBtnService.hide();\n      loadMore.removeEventListener('click', handlePagination);\n      iziToast.success({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n        color: 'blue',\n        icon: false,\n      });\n    }\n  } catch (err) {\n    console.log(err);\n  } finally {\n    loader.style.display = 'none';\n  }\n}"],"names":["axios","API_KEY","getImages","page","perPage","query","data","createCardsMarkup","cards","webformatURL","largeImageURL","tags","likes","views","comments","downloads","_ButtonService","buttonEl","__publicField","ButtonService","galleryLink","SimpleLightbox","gallery","loader","loadMore","loadMoreBtnService","searchForm","params","handleSearch","e","form","userQuery","iziToast","handlePagination","err","photosMarkup","rect","key"],"mappings":"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"}